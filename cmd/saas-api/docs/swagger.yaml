basePath: /
definitions:
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_payment.OrderItem:
    properties:
      product_id:
        type: string
      product_name:
        type: string
      quantity:
        type: integer
      subtotal:
        type: number
      unit_price:
        type: number
      variant_id:
        type: string
      variant_name:
        type: string
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Action:
    properties:
      config:
        additionalProperties: true
        description: Action-specific configuration
        type: object
      type:
        description: 'Action type: "send_whatsapp", "update_database", "call_api",
          etc.'
        type: string
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Condition:
    properties:
      field:
        description: Field to check (e.g., "total_amount", "customer_type")
        type: string
      logic:
        description: '"AND" or "OR" (default: "AND")'
        type: string
      operator:
        description: 'Operator: "equals", "greater_than", "less_than", "contains",
          etc.'
        type: string
      value:
        description: Value to compare against
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.CreateWorkflowRequest:
    properties:
      actions:
        items:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Action'
        minItems: 1
        type: array
      conditions:
        items:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Condition'
        type: array
      description:
        type: string
      is_active:
        description: Pointer to allow explicit false
        type: boolean
      name:
        type: string
      trigger_config:
        $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.TriggerConfig'
      trigger_type:
        enum:
        - event
        - scheduled
        - manual
        type: string
    required:
    - actions
    - name
    - trigger_config
    - trigger_type
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.TriggerConfig:
    properties:
      event_name:
        description: 'For event triggers: "transaction_created", "message_received",
          etc.'
        type: string
      schedule:
        description: 'For scheduled triggers: cron expression "0 18 * * *"'
        type: string
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.UpdateWorkflowRequest:
    properties:
      actions:
        items:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Action'
        minItems: 1
        type: array
      conditions:
        items:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.Condition'
        type: array
      description:
        type: string
      is_active:
        type: boolean
      name:
        type: string
      trigger_config:
        $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.TriggerConfig'
      trigger_type:
        enum:
        - event
        - scheduled
        - manual
        type: string
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.WorkflowExecutionRequest:
    properties:
      trigger_data:
        additionalProperties: true
        type: object
    type: object
  github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_modules_saas_services.CreateOrderRequest:
    properties:
      clientID:
        type: string
      customerName:
        type: string
      customerPhone:
        type: string
      items:
        items:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_payment.OrderItem'
        type: array
      totalAmount:
        format: float64
        type: number
    type: object
  internal_modules_saas_handlers.KnowledgeBaseRequest:
    properties:
      client_id:
        example: 7a393015-15b8-4bcf-8ce6-840f753bfb1c
        type: string
      content:
        type: object
      tags:
        example:
        - order
        - howto
        items:
          type: string
        type: array
      title:
        example: Cara Order
        type: string
      type:
        description: faq, product, service, policy, or any custom type
        example: faq
        type: string
    type: object
host: localhost:8080
info:
  contact:
    email: support@whatsapp-saas.com
    name: API Support
  description: API documentation for WhatsApp Bot SaaS (Modular Architecture)
  license:
    name: MIT
  termsOfService: http://swagger.io/terms/
  title: WhatsApp Bot SaaS API
  version: "2.0"
paths:
  /clients:
    get:
      description: Returns all clients with active subscription
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get all active clients
      tags:
      - Clients
  /clients/{id}:
    get:
      description: Returns a single client by ID
      parameters:
      - description: Client ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get client by ID
      tags:
      - Clients
  /health:
    get:
      description: Check if API is alive
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Service health check
      tags:
      - Health
  /knowledge-base:
    get:
      description: Returns knowledge base data for a client
      parameters:
      - description: Client ID
        in: query
        name: client_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get Knowledge Base by Client ID
      tags:
      - KnowledgeBase
    post:
      consumes:
      - application/json
      description: 'Adds knowledge base entry with flexible JSONB content. The ''content''
        field accepts any JSON structure. Examples: For FAQ use {"question":"...","answer":"..."},
        for Product use {"name":"...","price":50000,"description":"...","stock":100}'
      parameters:
      - description: Knowledge base data - content field accepts any JSON structure
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/internal_modules_saas_handlers.KnowledgeBaseRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Add new knowledge base item
      tags:
      - KnowledgeBase
  /ocr/process-receipt:
    post:
      consumes:
      - multipart/form-data
      description: Upload a receipt image, extract text using OCR, parse it, and create
        a transaction record
      parameters:
      - description: Client ID
        in: formData
        name: client_id
        required: true
        type: string
      - description: Receipt image file
        in: formData
        name: image
        required: true
        type: file
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Process receipt image and create transaction
      tags:
      - OCR
  /orders:
    post:
      consumes:
      - application/json
      description: Create a new order for a customer (admin only)
      parameters:
      - description: Order details
        in: body
        name: order
        required: true
        schema:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_modules_saas_services.CreateOrderRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Create a new order
      tags:
      - Orders
  /orders/{id}/cancel:
    post:
      description: Cancel a pending order
      parameters:
      - description: Order ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Cancel an order
      tags:
      - Orders
  /orders/{id}/confirm-payment:
    post:
      consumes:
      - application/json
      description: Admin manually confirms payment for an order
      parameters:
      - description: Order ID
        in: path
        name: id
        required: true
        type: string
      - description: Payment confirmation details
        in: body
        name: payment
        required: true
        schema:
          properties:
            notes:
              type: string
            payment_method:
              type: string
            reference:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Manually confirm payment (Admin)
      tags:
      - Orders
  /orders/{orderNumber}/status:
    get:
      description: Retrieve order and payment status by order number
      parameters:
      - description: Order Number
        in: path
        name: orderNumber
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get order status
      tags:
      - Orders
  /transactions:
    get:
      description: Retrieve transaction history for a specific client
      parameters:
      - description: Client ID
        in: query
        name: client_id
        required: true
        type: string
      - default: 50
        description: Limit number of results
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get transactions for a client
      tags:
      - Transactions
  /webhook:
    post:
      consumes:
      - application/json
      description: Receive webhook events from WhatsApp Provider (WAHA/GreenAPI)
      parameters:
      - description: Webhook payload
        in: body
        name: payload
        required: true
        schema:
          additionalProperties: true
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties: true
            type: object
      summary: WhatsApp webhook receiver
      tags:
      - Webhook
  /webhooks/midtrans:
    post:
      consumes:
      - application/json
      description: Handle Midtrans payment notifications
      parameters:
      - description: Midtrans notification
        in: body
        name: notification
        required: true
        schema:
          additionalProperties: true
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Midtrans payment webhook
      tags:
      - Webhooks
  /whatsapp/qr:
    get:
      description: Generate QR code for WhatsApp authentication
      parameters:
      - default: default
        description: Session ID
        in: query
        name: session_id
        type: string
      produces:
      - image/png
      responses:
        "200":
          description: OK
          schema:
            type: file
        "500":
          description: Internal Server Error
          schema:
            additionalProperties: true
            type: object
      summary: Get WhatsApp QR Code
      tags:
      - WhatsApp
  /whatsapp/session/restart:
    post:
      consumes:
      - application/json
      description: Stop and start a WhatsApp session
      parameters:
      - description: Session data
        in: body
        name: data
        required: true
        schema:
          properties:
            session_id:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties: true
            type: object
      summary: Restart WhatsApp session
      tags:
      - WhatsApp
  /whatsapp/session/start:
    post:
      consumes:
      - application/json
      description: Start a new WhatsApp session for a client
      parameters:
      - description: Session data
        in: body
        name: data
        required: true
        schema:
          properties:
            client_id:
              type: string
            session_id:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties: true
            type: object
      summary: Start WhatsApp session
      tags:
      - WhatsApp
  /whatsapp/session/status:
    get:
      description: Check if WhatsApp session is connected
      parameters:
      - default: default
        description: Session ID
        in: query
        name: session_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get WhatsApp session status
      tags:
      - WhatsApp
  /whatsapp/session/stop:
    post:
      consumes:
      - application/json
      description: Stop a WhatsApp session
      parameters:
      - description: Session data
        in: body
        name: data
        required: true
        schema:
          properties:
            session_id:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties: true
            type: object
      summary: Stop WhatsApp session
      tags:
      - WhatsApp
  /whatsapp/webhook/configure:
    post:
      consumes:
      - application/json
      description: Configure webhook URL for receiving WhatsApp messages
      parameters:
      - description: Webhook configuration
        in: body
        name: data
        required: true
        schema:
          properties:
            session_id:
              type: string
            webhook_url:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties: true
            type: object
      summary: Configure webhook for WhatsApp session
      tags:
      - WhatsApp
  /workflows:
    get:
      description: Retrieve all workflows for a specific client
      parameters:
      - description: Client ID
        in: query
        name: client_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: List workflows for a client
      tags:
      - Workflows
    post:
      consumes:
      - application/json
      description: Create a new automation workflow for a client
      parameters:
      - description: Workflow details
        in: body
        name: workflow
        required: true
        schema:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.CreateWorkflowRequest'
      - description: Client ID
        in: query
        name: client_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Create a new workflow
      tags:
      - Workflows
  /workflows/{id}:
    delete:
      description: Delete a workflow by ID
      parameters:
      - description: Workflow ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Delete a workflow
      tags:
      - Workflows
    get:
      description: Retrieve a specific workflow by its ID
      parameters:
      - description: Workflow ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get workflow by ID
      tags:
      - Workflows
    put:
      consumes:
      - application/json
      description: Update an existing workflow
      parameters:
      - description: Workflow ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated workflow details
        in: body
        name: workflow
        required: true
        schema:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.UpdateWorkflowRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Update a workflow
      tags:
      - Workflows
  /workflows/{id}/execute:
    post:
      consumes:
      - application/json
      description: Trigger a workflow execution manually
      parameters:
      - description: Workflow ID
        in: path
        name: id
        required: true
        type: string
      - description: Trigger data
        in: body
        name: request
        schema:
          $ref: '#/definitions/github_com_MuhamadAgungGumelar_micro-system-ai-agent-be_internal_core_workflow.WorkflowExecutionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Manually execute a workflow
      tags:
      - Workflows
  /workflows/{id}/executions:
    get:
      description: Retrieve execution history for a specific workflow
      parameters:
      - description: Workflow ID
        in: path
        name: id
        required: true
        type: string
      - default: 50
        description: Limit number of results
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get workflow execution history
      tags:
      - Workflows
swagger: "2.0"
